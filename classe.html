<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Questions rapides – Classe</title>
<link rel="stylesheet" href="style.css">

<style>
body{
  margin:0;
  background:#000;
  color:#fff;
  font-family:"Comic Sans MS","Segoe UI",system-ui,Arial,sans-serif;
}
h1{text-align:center;margin:20px 0}
.back{
  position:fixed;
  top:16px;
  left:16px;
  background:#1c1c1c;
  padding:10px 16px;
  border-radius:10px;
  border:1px solid #2a2a2a;
  text-decoration:none;
  color:#fff;
}
.wrap{padding:20px}
table{border-collapse:collapse;margin:auto}
td{
  border:1px solid #333;
  padding:10px;
  text-align:center;
}
td.done{background:#114d22}
a{color:#c4ffd1;font-weight:bold;text-decoration:none}
</style>
</head>

<body>
<a class="back" href="index.html">⬅ Accueil</a>
<h1 id="title"></h1>
<div class="wrap" id="content"></div>

<script>
const params=new URLSearchParams(location.search);
const CLASS=params.get("c");
const LV=parseInt(params.get("lv"),10);
document.getElementById("title").textContent=CLASS;

const pdfs=JSON.parse(localStorage.getItem("qr_pdfs_v1")||"[]");

function build(pdf){
  const max=Math.min(100,pdf.pages||100);
  const table=document.createElement("table");
  const tr=document.createElement("tr");

  const key="qr_state_"+CLASS+"_"+pdf.name;
  let state=JSON.parse(localStorage.getItem(key)||"[]");

  for(let i=1;i<=max;i++){
    const td=document.createElement("td");
    td.textContent="Q"+i;
    if(state.includes(i)) td.classList.add("done");

    td.onclick=()=>{
      if(state.includes(i)) state=state.filter(x=>x!==i);
      else state.push(i);
      localStorage.setItem(key,JSON.stringify(state));
      td.classList.toggle("done");
    };

    const a=document.createElement("a");
    a.href=encodeURI(pdf.name)+"#page="+i;
    a.target="_blank";
    a.textContent="Q"+i;
    td.innerHTML="";
    td.appendChild(a);
    tr.appendChild(td);
  }

  table.appendChild(tr);
  const h=document.createElement("h2");
  h.textContent=pdf.name.replace(/\.pdf$/i,"");
  const div=document.createElement("div");
  div.append(h,table);
  return div;
}

const c=document.getElementById("content");
pdfs.forEach(p=>c.appendChild(build(p)));
</script>
</body>
</html>
